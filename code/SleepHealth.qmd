---
title: "Sleep, Health and Lifestyle Dataset Analysis "
format: html
theme: superhero
execute:
  echo: false
  error: true
---

```{r message=FALSE}
library(tidyverse)

ss <- read_csv(here::here("data", "raw", "ss.csv"))

```

Renaming varibables as dataset is already cleaned

```{r}
ss_clean <- ss %>%
	rename(
		Person_ID = `Person ID`,
		Sleep_Duration = `Sleep Duration`,
		Sleep_Quality = `Quality of Sleep`,
		Physical_Activity_Level = `Physical Activity Level`,
		Stress_Level = `Stress Level`,
		BMI_Category = `BMI Category`,
		Heart_Rate = `Heart Rate`,
		Daily_Steps = `Daily Steps`,
		Sleep_Disorder = `Sleep Disorder`
	)
```

# Data Description

The data set examined in this final project report is the "Sleep, Health, and Lifestyle" data set. This data set was created by Henry Shan and is accessible through the Kaggle website.The data set contains a wide range of variables related to sleep and daily routines. The data set includes variables such as gender, age, occupation, sleep duration, sleep quality, physical activity, stress level, BMI, blood pressure, heart rate, daily steps taken, and presence of sleep disorders.

<https://www.kaggle.com/datasets/henryshan/sleep-health-and-lifestyle/data>

# Table of Descriptive Statistics

```{r}
#| label: fig-table1
#| fig-cap: "Table 1: This table presents the distribution of key characteristics among female (N = 1,841) and male (N = 1,891) participants. Values are expressed as median (Q1, Q3) or n (%). The characteristics include sleep duration, physical activity level, BMI category, heart rate, daily steps, and presence of sleep disorders. Notable findings include similar median sleep durations and physical activity levels between genders, but significant differences in BMI categories and the prevalence of sleep disorders, particularly sleep apnea, which was more common among females."

library(gtsummary)

tbl_summary(
  ss_clean,
  by = Gender,
  include = c(Gender, Sleep_Duration, Physical_Activity_Level, 
  						BMI_Category, Heart_Rate, Daily_Steps, Sleep_Disorder),
  label = list(
  	Sleep_Duration ~ "Sleep Duration",
  	Physical_Activity_Level ~ "Physical Activity Level",
  	BMI_Category ~ "BMI Category",
  	Heart_Rate ~ "Heart Rate",
  	Daily_Steps ~ "Daily Steps",
  	Sleep_Disorder ~ "Sleep Disorder"
  ))
```


# Regression Analysis

```{r}
univar_reg <- tbl_uvregression(
  data = ss_clean,
  y = Sleep_Duration,
  include = c(
    Gender, Sleep_Duration, Sleep_Quality, Stress_Level, 
    BMI_Category, Sleep_Disorder),
  method = lm
)

univar_reg

```


# Figures
```{r}
#| label: fig-boxplot
#| fig-cap: "Figure 1: In this boxplot, comparing both males and females in the dataset, the median sleep duration for females (represented by the red boxplot) is approximately 8 hours. The median sleep duration for males (represented by the blue boxplot) is around 7 hours. Females tend to have longer sleep durations."

library(ggplot2)


# Boxplot by Gender
ggplot(ss_clean, aes(x = Gender, y = Sleep_Duration, fill = Gender)) +
  geom_boxplot() +
  labs(
    title = "Boxplot of Sleep Duration by Gender",
    x = "Gender",
    y = "Sleep Duration"
  )



```

```{r}
#| label: fig-table2
#| fig-cap: "Table 2 shows the descriptive statistics"
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sex_cat, race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir),
  label = list(
    race_eth_cat ~ "Race/ethnicity",
    region_cat ~ "Region",
    eyesight_cat ~ "Eyesight",
    glasses ~ "Wears glasses",
    age_bir ~ "Age at first birth"
  ),
  missing_text = "Missing")
```

@fig-table1 contains a table that illustrates the baseline characteristics of study participants by gender and @fig-boxplot contains a boxplot that compares the sleep duration between males and females.

```{r}

# Error in this code was that nlsy was originally all capitalized as R is case sensitive
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sex_cat, race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir))
```

Weâ€™re using some data from the National Longitudinal Survey of Youth 1979, a cohort of American young adults aged 14-22 at enrollment in 1979. They continue to be followed to this day, and there is a wealth of publicly available data online. Iâ€™ve downloaded the answers to a survey question about whether respondents wear glasses, a scale about their eyesight with glasses, their (NLSY-assigned ðŸ˜’) race/ethnicity, their sex (presumably at birth, but unclear), their familyâ€™s income in 1979, and their age at the birth of their first child.

```{r}
mean_sleep_weekend <- mean(nlsy$sleep_wknd, na.rm = TRUE)
mean_sleep_weekend
```

1.  There mean number of hours was `r mean_sleep_weekend`
2.  There mean number of hours was `r mean(nlsy$sleep_wknd, na.rm = TRUE)`

```{r}
median_sleep_weekend <- median(nlsy$sleep_wknd, na.rm = TRUE)
median_sleep_weekend
```

3.  The median numbers of hours was `r median_sleep_weekend` participants
4.  The median numbers of hours was `r mean(nlsy$sleep_wknd, na.rm = TRUE)` participants"

```{r}
#| eval: true
#| label: tbl-descr
#| tbl-cap: "Descriptive statistics"
#| output-location: slide
table1 <- tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sex_cat, race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir, sleep_wknd)) |> 
  add_overall(last = TRUE)

table1

mean_hrs_sleep <- inline_text(table1, variable = "sleep_wknd", column = "stat_0")
```

The median and IQR are `r mean_hrs_sleep`
